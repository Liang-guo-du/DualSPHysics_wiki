Some demonstration cases are included in the DualSPHysics package (Figure 12.1); such as a dam break interacting with an obstacle in a tank, waves on a beach created by a piston or the real geometry of a pump mechanism that translates water within a storage tank.

<p align="center">
<img src="https://imgur.com/ko8d0Rh.png" />
</p>

<p align="center">
<strong>Figure 12-1.</strong> Test cases: dambreak, wavemaker, and pump.
</p>

The different test cases are described in the following sections. The scripts (_.bat_ in Windows and _.sh_ in Linux) are presented and the different command line instructions to execute the different programs are described. The XML files are also explained in detail to describe the execution parameters and the different labels to plot boundaries, fluid volumes, movements, etc. 

For each case there are 4 options; 
* wCase_win64_CPU.bat (windows on CPU)
* wCase_win64_GPU.bat (windows on GPU)
* xCase_linux64_CPU.sh (linux on CPU)
* xCase_linux64_GPU.sh (linux on GPU)

Since many 3-D applications can be reduced to a 2-D problem, the executable of DualSPHysics can also perform 2-D simulations, however this option is not fully optimized. A 2-D simulation can be achieved easily by imposing the same values in the Y-direction (`<pointmin>` = `<pointmax>` in the input XML file). For example, see the two-dimensional 01_DamBreak indicated in Figure 12-2. Thus, the initial configuration is a 2-D system and DualSPHysics will detect automatically that the simulation must be carried out using the 2-D formulation.

 
The different CASES provided are intended as worked examples for users to create their own cases, to learn the different available options and what post-processing tools can be used. The following list summarises the testcases that can be found in **examples/main**:

01_DAMBREAK
* 3-D dam break flow impacting on a structure: numerical velocity, pressure and force are computed.
* 2-D dam break and validation data from [Koshizula and Oka, 1996] experiment.

02_PERIODICITY
* 2-D case with Periodicity in X direction. 
Delta-SPH is also used.

03_MOVINGSQUARE
* 2-D case with square that moves with rectilinear movement.
Example of no gravity so parameter “b” needs to be specified by the user. 
Shifting is used for this internal flow (no need to detect free surface).

04_EXTERNALFORCES
* External acceleration is loaded from a file and applied to two different volumes of fluid.
Delta-SPH is also used.

05_SLOSHINGTANK
* 2-D sloshing tank that reads external acceleration from a file.
* 2-D sloshing tank that reads the rotational movement of the tank itself from a file.
Validation with SPHERIC Benchmark #10 where pressure is computed.

06_WAVEMAKER
* 3-D tank with Periodicity in Y direction and piston with sinusoidal movement. 
Delta-SPH and Shifting are used.

07_WAVEMAKERFILE
* 2-D tank with piston motion loaded from external file and external structure (STL).  
Validation data from CIEMito experiment: numerical computation of wave surface elevation and force exerted onto the wall.

08_WAVESFLAP
* 2-D regular waves generated with flap and comparison with 2nd order wave theory (beach).
* 2-D irregular waves generated with flap and comparison with 2nd order wave theory (beach).

09_WAVESPISTON
* 2-D regular waves with piston and comparison with 2nd order wave theory (beach & damping).
* 2-D irregular waves with piston and comparison with 2nd order wave theory (beach & damping).

10_WAVESPISTONAWAS
* 2-D regular waves generated with piston interacting with a vertical wall with and without AWAS
* 2-D regular waves generated with piston interacting with a trapezoidal dike with and without AWAS
Forces against the wall and dike with and without AWAS are compared.
Overtopping in the case of dike with and without AWAS is also compared.

 
11_FLOATING
* 3-D floating box in a wave tank with Periodicity in Y direction and piston with sinusoidal movement. Delta-SPH is used.
* 2-D falling sphere that uses laminar+SPS viscosity. Validation data from [Fekken, 2004] and [Moyo and Greenhow, 2000].

12_FLOATINGWAVES
* 2-D floating box under the action of non-linear waves in a tank with flap that reads rotational motion from an external file and uses laminar+SPS viscosity. 
Validation data (motions of the box) from [Hadzic et al., 2005].
* 2-D floating box under the action of regular waves in a tank with piston. 
Validation data (motions of the box) from [Ren et al., 2015].

13_PUMP
* 3-D external geometries are imported (STL) and filling algorithm is used.
Rotational movement is imposed.

14_DEM
* 2-D case only with DEM of a ball that impacts with blocks. Example without fluid particles.
* 3-D dam-break and blocks where interaction between blocks and with walls used DEM and properties of materials. Delta-SPH is also used.
* 2-D case with 2000 floating objects that interact in terms of DEM approach.

15_POISEUILLE
* 2-D case of Poiseuille flow with laminar+SPS viscosity and using high resolution 

## 12.1 DAMBREAK

A 2-D dam break can be executed using _wCaseDambreakVal2D_win64_GPU.bat_ (_xCaseDambreakVal2D_linux64_GPU.sh_ in linux), which is the file that summarises the tasks to be carried out using the different codes in a given order: 

<p align="center">
<img src="https://i.imgur.com/1geUGm8.png" />
</p>

Figure 12-2 shows different instants of the CaseDambreakVal2D simulation. The left frames show the PartFluid_xxxx.vtk (computed with **PartVTK**) and the right ones show the Slices_xxxx.vtk (obtained with **IsoSurface**) 

<p align="center">
<img src="https://i.imgur.com/Xw77I5u.png" />
</p>

<p align="center">
<strong>Figure 12-2.</strong> Instants of the CaseDambreakVal2D simulation. Colour represents velocity of the particles.
</p>

With this example, the experimental data of [Koshizuka and Oka, 1996] can be numerically reproduced. The file _EXP_X-DamTipPosition_Koshizula&Oka1996.txt_ includes the X-position of the tip of the dam for several instants (before the impact with the other wall).  

Numerical gauges (`<gauges>`) allows the user to compute different magnitudes during the execution of DualSPHysics. In this case, two gauges were created at x=0.2 to compute the water column height evolution and at z=0.03 to compute the X-position of the tip of the dam. The gauges can be also observed in the right panel of Figure 12-2.

The 3-D test case consists of a dam-break flow impacting with a structure inside a numerical tank. No moving boundary particles are involved in this simulation and no movement is defined. This case is executed using _wCaseDambreak_win64_GPU.bat_ (_xCaseDambreak_linux64_GPU.sh_ in linux),

Different instants of the CaseDambreak simulation are shown in Figure 12-3 where the _PartFluid_xxxx.vtk_ of the fluid particles, the _CaseDambreak_Box_Dp.vtk_ and _CaseDambreak_Building_Dp.vtk_ are depicted. 

<p align="center">
<img src="https://i.imgur.com/VmJoCXu.png" />
</p>

<p align="center">
<strong>Figure 12-3.</strong> Instants of the CaseDambreak simulation visualized using Paraview. Colour represents velocity of the particles.
</p>

Using **MeasureTool** code, numerical velocities have been computed in the list of points described in the file **CaseDambreak_PointsVelocity.txt**, which are (0.754, 0.31, 0.02), (0.754, 0.31, 0.04) and (0.754, 0.31, 0.06) using information of fluid particles within the kernel interaction. Numerical values of Vx-velocity in the x-direction are shown in Figure 12-4 for these three points.

<p align="center">
<img src="https://i.imgur.com/rXF6fbH.png" />
</p>

<p align="center">
<strong>Figure 12-4.</strong> Numerical velocity computed at three different locations.
</p>

Pressure values are also computed using **MeasureTool** in the list of points described in the file _CaseDambreak_PointsPressure.txt_, which corresponds to locations in the front wall of the structure (Figure 12-5) using information of fluid particles within the kernel interaction. Due to the use of the dynamic boundaries, probes used for measuring quantities should not be placed at the exact position of boundary particles. The forces exerted by the boundary particles create a small gap between them and fluid particles (1.5 times _h_); as a result, probes placed inside the gap will have a reduced fluid particle population and will produce either an incorrect or no result. To avoid this issue, it is proposed that probes are placed at a distance 1.5h from the boundary positions.

In this example, the _PointsPressure_Incorrect_ probes are placed at the exact position as the boundary particles at the building, while the _PointsPressure_Correct_ probes are placed at a distance of 1.5_h_ (for the default conditions and parameters of the case) from the boundaries. The first probes produce no pressure results as the number of fluid particles for the interpolation is too small, while the second shows the pressure impact by the water flow. 

<p align="center">
<img src="https://i.imgur.com/QaXHq6U.png" />
</p>

<p align="center">
<strong>Figure 12-5.</strong> Position of incorrect (red) and correct (green) pressure probes in CaseDambreak.
</p>

Note that the probes are not automatically associated with the smoothing length _h_ and their position has to be changed manually if the resolution changes. Also, note that by increasing resolution (i.e. using a smaller “dp”) the gap is reduced.
 
Figure 12-6 shows the pressure computed at the correct numerical probes.  

<p align="center">
<img src="https://i.imgur.com/Pn96uAP.png" />
</p>

<p align="center">
<strong>Figure 12-6.</strong> Pressure values computed at different locations in CaseDambreak.
</p>

This case also shows how to compute forces exerted against a structure. In this way the force is computed using **ComputeForces** as the summation of the acceleration values of the boundary particles that form the front wall of the structure (mk=21) multiplied by mass. Figure 12-7 shows the time series of the numerical force.

<p align="center">
<img src="https://i.imgur.com/l9pSnE9.png" />
</p>

<p align="center">
<strong>Figure 12-7.</strong> Force (X-component) exerted on the front wall of the structure in CaseDambreak. 
</p>

In fact, the methodology outlined here was used in for the validation of DualSPHysics presented in [Crespo et al. (2011)].

Finally, an example to use **FlowTool** is also available in CaseDambreak. Two different domains are defined in the text file _CaseDambreak_FileBoxes.txt_. Figure 12-8 shows the red domain (RESERVOIR) where the water reservoir was initially created and the green box (TANK) to compute the flow rate in front of the obstacle.  The output VTK files named _Boxes_xxxx.vtk_ are also depicted in Figure 12-8 and the colour corresponds to the domain to which they belong.

<p align="center">
<img src="https://i.imgur.com/oJdCzQF.png" />
</p>

<p align="center">
<strong>Figure 12-8.</strong> Domains to compute flow in CaseDambreak; RESERVOIR (red) and TANK (green).
</p>

**FlowTool** also creates a CSV file, named ResultFlow.csv. Hence, figure 12-9 represents the outflow of the red domain and the inflow into the green one. 

<p align="center">
<img src="https://i.imgur.com/guTFz1S.png" />
</p>

<p align="center">
<strong>Figure 12-9.</strong> Outflow in the domain RESERVOIR and inflow in the domain TANK.
</p>

## 12.2 PERIODICITY
This testcase is an example of periodicity applied to 2-D case where particles that leave the domain through the right wall are introduced through the left wall with the same properties but where the vertical position can change (with an increase of +0.3 in Z-position). _wCasePeriodicity.bat_ (_xCasePeriodicity.sh_ in linux) file summarises the tasks to be carried out using the different codes.

Different instants of the CasePeriodicity simulation are shown in Figure 12-10 where the _PartFluid_xxxx.vtk_ of the fluid particles and the _CasePeriodicity_Bound.vtk_ are depicted.

<p align="center">
<img src="https://i.imgur.com/kPMJKkX.png" />
</p>

<p align="center">
<strong>Figure 12-10.</strong> Different instants of the CasePeriodicity simulation. Colour represents Id of the fluid particles.
</p>

## 12.3 MOVINGSQUARE

A 2-D case without gravity is simulated. A square box is moving with uniform velocity (`<mvrect>`) inside the numerical tank – [see SPHERIC Benchmark #2](http://spheric-sph.org/tests/test-6). Gravity is set to zero, which means that parameter “b” cannot be automatically computed following equation of state (Eq. 14) and needs to be specified in `<constantsdef>` (`<b value="1.1200e+05" auto="false" />`).  The value of “b” is chosen to ensure that the speed of sound, cs, is at least 10 times the maximum particle velocity to maintain weak compressibility, that is vmax, cs ≥ 10 vmax.  Shifting is used for this internal flow to prevent the appearance of voids in the fluid. The case can be also executed without applying shifting to observe the problem of the voids.

_wCaseMovingSquare.bat_ (_xCaseMovingSquare.sh_ in linux) file summarises the tasks to be carried out using the different codes. The same case but without using shifting can be also executed to observe how the voids behind the moving object are not avoided if shifting is not applied.

Different instants of the CaseMovingSquare simulation are shown in Figure 12-11 where the _PartFluid_xxxx.vtk_ of the fluid particles and the _Square_xxxx.vtk_ are depicted.

<p align="center">
<img src="https://i.imgur.com/vAYUWzJ.png" />
</p>

<p align="center">
<strong>Figure 12-11.</strong> Different instants of the CaseMovingSquare simulation. Colour represents the velocity of the fluid.
</p>

## 12.4 EXTERNALFORCES

This is a testcase where external forces are applied to the system. The external forces can be loaded from the files _CaseForcesData_0.csv_ and _CaseForcesData_1.csv_. 

_wCaseForces.bat_ (_xCaseForces.sh_ in linux) file summarises the tasks to be carried out using the different codes.

Figure 12-12 shows the external forces that will be applied to the fluid particles inside the numerical tank. This mimics the effect of a box being accelerated in one direction and rotating around the y-axis.

<p align="center">
<img src="https://i.imgur.com/Wj5APtu.png" />
</p>

<p align="center">
<strong>Figure 12-12.</strong> External forces applied to the fluid particles in CaseForces.
</p>

Different instants of the simulation can be observed in Figure 12-13 where the _PartFluid_xxxx.vtk_ of the fluid particles and the file _CaseForces_Dp.vtk_ are depicted. The colours of the fluid particles correspond to the two different MK values.

<p align="center">
<img src="https://i.imgur.com/Avrz1s4.png" />
</p>

<p align="center">
<strong>Figure 12-13.</strong> Different instants of the CaseForces simulation.
</p>

## 12.5 SLOSHINGTANK

A 2-D sloshing tank is simulated in two different forms:
a)	CaseSloshingAcc: External acceleration is loaded from the CSV file _CaseSloshingAccData.csv_ and applied to the fluid particles.
b)	CaseSloshingMotion: Rotational movement is applied to the tank using prescribed rotation defined in the text file _CaseSloshingMotionData.dat_ (`<mvrotfile>`) that contains time and degrees (as shown in Figure 12-14).

<p align="center">
<img src="https://i.imgur.com/yfzYGjz.png" />
</p>

<p align="center">
<strong>Figure 12-14.</strong> Rotation movement prescribed in file CaseSloshingMotion.dat. 
</p>

_wCaseSloshing.bat_ (_xCaseSloshing.sh_ in linux) file summarises the tasks to be carried out using the different codes for the two cases. Different instants of the simulation can be observed in Figure 12-15 where the files _PartAll_xxxx.vtk_ are depicted.

<p align="center">
<img src="https://i.imgur.com/PavVrvM.png" />
</p>

<p align="center">
<strong>Figure 12-15.</strong> Different instants of the CaseSloshingMotion simulation. Colour represents the velocity of the fluid.
</p>

Validation with [SPHERIC Benchmark #10](http://spheric-sph.org/tests/test-10) is also included. Experimental pressure is available in _EXP_Pressure_SPHERIC_Benchmark#10.txt_. Numerical pressures are computed using _MeasureTool_ in both cases. CaseSloshingAcc reads a text file with the fixed position (-0.45, 0, 0.093) while CaseSloshingMotion reads a CSV file with the position of the sensor at each time since the point to measure also moves with the tank. 

Hence, numerical pressure is computed at the location of the experimental sensor (_PointsPressure_Incorrect_) and at a distance of 1.5h from the boundaries (_PointsPressure_Correct_) as shown in Figure 12-16. The first probe produces no pressure results as the number of fluid particles for the interpolation is too small, while the second shows the pressure impact by the water flow. 

<p align="center">
<img src="https://i.imgur.com/g1gcfeg.png" />
</p>

<p align="center">
<strong>Figure 12-16.</strong> Position of incorrect and correct pressure probes in CaseSloshing.
</p>

Note that the probes are not automatically associated with the smoothing length _h_ and their position has to be changed manually if the resolution (or particle size “dp”) changes. Also, note that by increasing resolution the gap is reduced. Using **BoundaryVTK**, the user can compute the time history of the position of the moving point initially at 1.5_h_ of the wall to obtain new positions to be used with **MeasureTool**.

Figure 12-17 shows the numerical pressure computed using **MeasureTool** in both cases and compared with the experimental signal. Results improve using higher resolution than the one used here.

<p align="center">
<img src="https://i.imgur.com/v2UUaA4.png" />
</p>

<p align="center">
<strong>Figure 12-17.</strong> Experimental and numerical pressure at Sensor1 in CaseSloshing.
</p>

## 12.6 WAVEMAKER

CaseWavemaker simulates several waves breaking on a numerical beach. A wavemaker is performed to generate and propagate the waves. In this testcase, a sinusoidal movement (`<mvrectsinu>`) is imposed to the boundary particles of the wavemaker and Periodicty in Y direction is also used. _wCaseWavemaker.bat_ (_xCaseWavemaker.sh_ in linux) file describes the execution task to be carried out in this directory.

The files _MotionPiston_xxxx.vtk_ containing the position of the wavemaker at different instants and _Surface_xxxx.vtk_ containing the surface representation are used to display the results in Figure 12-18:

<p align="center">
<img src="https://i.imgur.com/C6NFNeY.png" />
</p>

<p align="center">
<strong>Figure 12-18.</strong> Different instants of the CaseWavemaker simulation. Colour represents surface velocity.
</p>

Using the **MeasureTool** code, numerical wave elevations have been computed in the list of points described in the file _CaseWavemaker_PointsHeights.txt_. So that, _PointsHeights_h_xxxx.vtk_ are now depicted in Figure 12-19.

<p align="center">
<img src="https://i.imgur.com/P7jJVhO.png" />
</p>

<p align="center">
<strong>Figure 12-19.</strong> Different instants of the CaseWavemaker simulation. Colour represents wave elevation.
</p>

**MeasureTool** is also used to compute the wave elevation at one wave gauge located at x=1, y=1 (_CaseWavemaker_wg0_3D.txt_) and the output result can be analysed in _WG0_Height.csv_.

## 12.7 WAVEMAKERFILE

This 2-D case aims to mimic an experiment performed in [CIEMito wave flume](http://ciemlab.upc.edu/en/facilities/ciemito) at the Universitat Politècnica de Catalunya (UPC) in Barcelona. The movement of the piston is prescribed in the file _CaseWavemaker2D_Piston_Movement.dat_ (`<mvfile>`) and an external structure is loaded (_CaseWavemaker2D_Structure.stl_). 

The _wCaseWavemaker2D.bat_ (_xCaseWavemaker2D.sh_ in linux) file describes the execution tasks to be carried out in this directory.  

Different instants of the CaseWavemaker2D simulation are shown in Figure 12-20 where the _PartFluid_xxxx.vtk_ of the fluid particles and the _PartMoving_xxxx.vtk_ of the piston are depicted.

<p align="center">
<img src="https://i.imgur.com/8mtFGqH.png" />
</p>

<p align="center">
<strong>Figure 12-20.</strong> Different instants of the CaseWavemaker2D simulation. The three black dots represent the wave gauges _wg1, wg2, wg3_ used for validation. Colour represents the horizontal velocity of the fluid.
</p>

This case also includes validation data from the CIEMito experiment: wave surface elevation at different locations (_CaseWavemaker2D_wg1_2D.txt_, _CaseWavemaker2D_wg2_2D.txt_ and _CaseWavemaker2D_wg3_2D.txt_) and force exerted onto the right wall. 

Figure 12-21 shows the experiment and numerical time series of wave surface elevation at wg1 obtained using **MeasureTool**.

<p align="center">
<img src="https://imgur.com/KnBP8Ov.png" />
</p>

<p align="center">
<strong>Figure 12-21.</strong> Numerical and experimental wave elevation at wg1 in CaseWavemaker2D.
</p>

This case also computes forces exerted against the structure in the final of the tank. The force is computed using ComputeForces as the summation of the acceleration values of the boundary particles that form the front wall (id:1616-1669) multiplied by mass. Figure 12-22 shows the time series of the numerical force. Note that initial hydrostatic force is 20.72 N (the initial depth in front of the wall is 0.065 m)

<p align="center">
<img src="https://i.imgur.com/yr9eedq.png" />
</p>

<p align="center">
<strong>Figure 12-22.</strong> Force (X-component) exerted on the right wall in CaseWavemaker2D.
</p>

## 12.8 WAVESFLAP

Several examples of automatic generation of waves are included in the new package: monochromatic (regular) waves and irregular waves are generated using flap- and piston-type wavemakers. 

Second-order waves are simulating (Figure 12-23), corresponding to results shown in [Altomare et al., 2017]. The wave height, wave period, water depth at wave generation, wave steepness and wavelength are summarised in the following table. The quantities _H_ and _T_ refer to the wave height and wave period of the first-order component of the monochromatic waves; _Hm0_ and _Tp_ are the significant wave height and peak wave period of the irregular wave train, respectively.

<p align="center">
<img src="https://i.imgur.com/h9YXi4t.png" />
</p>

<p align="center">
<strong>Figure 12-23.</strong> Wave conditions on Le Mehaute abacus [Le Mehaute, 1976].
</p>

This first testcase includes wave generation using FLAP. 
_wCaseFlapBeach_REG.bat_ (_xCaseFlapBeach_REG.sh_ in linux) file describes the execution tasks to be carried out in this directory to create monochromatic waves (`<flap>`). In order to reproduce only incident waves, passive absorption is used here to prevent reflection. In this case the passive absorption consists of a dissipative beach at the end of the tank. 

Different instants of the CaseFlapBeach_REG simulation are shown in Figure 12-24 where the _PartFluid_xxxx.vtk_ of the fluid particles and the _PartFlap_xxxx.vtk_ of the flap are depicted.

<p align="center">
<img src="https://i.imgur.com/irqV5RH.png" />
</p>

<p align="center">
<strong>Figure 12-24.</strong> Different instants of the CaseFlapBeach_REG simulation. Colour represents the horizontal velocity of the fluid.
</p>

Numerical results using **MeasureTool** are compared with theoretical ones (that can also be computed by DualSPHysics using option `<savemotion>` in the XML configuration). Figure 12-25 shows the comparison of numerical water surface elevation measured (at a distance of 6 m of the piston) and numerical vertical and horizontal velocity (at 6 m of the piston and 0.26 m from still water level) with the theoretical results using second-order solutions. Note that numerical results agree with second-order theory, which validates the correct generation and propagation using DualSPHysics using flap.

<p align="center">
<img src="https://i.imgur.com/ByTvfB5.png" />
</p>

<p align="center">
<strong>Figure 12-25.</strong> Comparison between theoretical and numerical water surface elevation and orbital velocities for regular waves in CaseFlapBeach_REG.
</p>

The second case computes the movement of a piston to generate irregular. A pre-defined JONSWAP spectrum is used to characterised the irregular wave train in the frequency domain (`<flap_spectrum>`). 

_wCaseFlapBeach_IRREG.bat_ (_xCaseFlapBeach_IRREG.sh_ in linux) file describes the execution tasks to be carried out in this directory to create irregular random waves.

Figure 12-26 also shows the comparison of numerical wave surface elevation and horizontal velocity (obtained with **MeasureTool**) with the theoretical solution (using `<savemotion>`). Good agreement is also observed for irregular waves. Only first-order wave generation for irregular waves is implemented for flap-type wavemaker. Therefore, possible differences between the numerical and theoretical results are expected. Yet, in the case shown in Figure 12-26 these differences are negligible.

<p align="center">
<img src="https://i.imgur.com/Fgb2jsa.png" />
</p>

<p align="center">
<strong>Figure 12-26.</strong> Comparison between theoretical and numerical water surface elevation and orbital velocities for regular waves in CaseFlapBeach_IRREG.
</p>

The file “_CaseFlap_SPHvsTheory.ods_” includes all these comparisons.

## 12.9 WAVESPISTON

The same wave condition shown in Figure 12-23 is now created using a piston-type wavemaker. Regular (`<piston>`) and random (`<piston_spectrum>`) waves are created. Two different passive absorption systems are used to avoid reflection at the end of the tank; a dissipative beach and a sponge layer or damping (`<damping>`).
Therefore, different scripts can be used here:
* _wCasePistonBeach_REG.bat_ (_xCasePistonBeach_REG.sh_ in linux)
* _wCasePistonBeach_IRREG.bat_ (_xCasePistonBeach_IRREG.sh_ in linux)
* _wCasePistonDamping_REG.bat_ (_xCasePistonDamping_REG.sh_ in linux)
* _wCasePistonDamping_IRREG.bat_ (_xCasePistonDamping_IRREG.sh_ in linux)

Different instants of the CasePistonBeach_REG simulation are shown in Figure 12-27 where the _PartFluid_xxxx.vtk_ of the fluid particles and the _PartPiston_xxxx.vtk_ of the piston are depicted.

<p align="center">
<img src="https://i.imgur.com/QMxY7OD.png" />
</p>

<p align="center">
<strong>Figure 12-27.</strong> Different instants of the CasePistonBeach_REG simulation. Colour represents the horizontal velocity of the fluid.
</p>

Note how the same instants are shown in the images of Figure 12-27 (using piston) and the images of Figure 12-24 (using flap), and it can be observed how the same waves are created using both wavemakers. Figure 12-28 proves the similar behaviour of both passive absorption systems in the case of regular waves; dissipative beach and sponge layer (damping). Same behaviour is obtained for the irregular tests.

<p align="center">
<img src="https://i.imgur.com/2lZtWas.png" />
</p>

<p align="center">
<strong>Figure 12-28.</strong> Same instant of the CasePistonBeach_REG and CasePistonDamping_REG simulations. Colour represents the horizontal.
</p>

Figure 12-29 shows the comparison of numerical wave surface elevation measured (at a distance of 6 m of the piston) and numerical vertical and horizontal velocity (at 6 m of the piston and 0.26 m from still water level) with the theoretical result using second-order solutions for the case of regular waves. Note that numerical results agree with second-order theory, which validates the correct generation and propagation using DualSPHysics using piston (as shown in [Altomare et al., 2017]). 

<p align="center">
<img src="https://i.imgur.com/oAoSEUL.png" />
</p>

<p align="center">
<strong>Figure 12-29.</strong> Comparison between theoretical and numerical water surface elevation and orbital velocities for regular waves in CasePistonBeach_REG.
</p>

The file “CasePiston_SPHvsTheory.ods” includes more comparisons between the theoretical and numerical results for both regular and irregular waves and for both passive absorptions systems (beach and the sponge layer). Similar accuracy was obtained in all the cases. 

## 12.10 WAVESPISTONAWAS

This third cases focused on wave generation includes now the option of using Active Wave Absorption System (AWAS) that is only implemented for the piston-type wavemaker in DualSPHysics. 
The XML includes this option with `<piston>` or `<piston_spectrum>` using `<awas_zsurf>`

The AWAS system will absorb the reflected waves that impact with the numerical piston. Therefore, no passive absorption systems are used at the end of the tank because the aim is to absorb the reflected waves while the piston generates the incident ones.

A case with a vertical wall and other with a trapezoidal dike can be executed to analyse the effects of using AWAS. Therefore, different scripts can be used here:
* _wCasePistonWallAWAS_REG.bat_ (_xCasePistonWallAWAS_REG.sh_ in linux)
* _wCasePistonWallNoAWAS_REG.bat_ (_xCasePistonWallNoAWAS_REG.sh_ in linux)
* _wCasePistonDikeAWAS_REG.bat_ (_xCasePistonDikeAWAS_REG.sh_ in linux)
* _wCasePistonDikeNoAWAS_REG.bat_ (_xCasePistonDikeNoAWAS_REG.sh_ in linux)

In the cases with AWAS, incident and reflected wave are being propagated in the tank, however without AWAS also the re-reflected waves are included in the wave field. Re-reflected waves are those that, propagating backwards to the piston will be reflected by the piston surface and will travel back propagating in the same direction as the incident waves. The energy of the re-reflected wave will sum-up with the one characterising the incident wave field, biasing the results.

For the case of wave generation with active wave absorption for monochromatic waves, a standing wave is expected to be generated in the computational domain. Different instants of the CasePistonWallAWAS_REG simulation are shown in Figure 12-30 where the _PartFluid_xxxx.vtk_ of the fluid particles and the _PartPiston_xxxx.vtk_ of the piston using AWAS are depicted. In this case only incident and reflected waves are being propagated in the tank since re-reflection is prevented using AWAS. It can be observed how the velocity field is repeated every 2 seconds (wave period) which proves the correct behaviour of the AWAS implementation. 

If force against the vertical wall is computed, the effect of AWAS can be also analysed. If the re-reflected waves are prevented, then only incident waves should impact on the right vertical wall, which were generated as regular waves, so that regular pattern in the time series of force should be observed. Using _ComputeForces_, the force exerted onto the vertical wall was computed with and without AWAS. The Figure 12-31 demonstrates that time series of the wave force when the piston includes AWAS follows regular cycles.

<p align="center">
<img src="https://i.imgur.com/YLh0ODm.png" />
</p>

<p align="center">
<strong>Figure 12-30.</strong> Different instants of the CasePistonWallAWAS_REG simulation. Colour represents the horizontal velocity of the fluid.
</p>

<p align="center">
<img src="https://i.imgur.com/M0xjOaU.png" />
</p>

<p align="center">
<strong>Figure 12-31.</strong> Comparison between force exerted onto the right vertical wall with AWAS (CasePistonWallAWAS_REG) and without (CasePistonWallNoAWAS_REG) AWAS. 
</p>

The second example using AWAS includes a trapezoidal dike at the end of the tank. 
Different instants of the CasePistonDikeAWAS_REG simulation are shown in Figure 12-32 where the PartFluid_xxxx.vtk of the fluid particles and the PartPiston_xxxx.vtk of the piston using AWAS are depicted.

<p align="center">
<img src="https://i.imgur.com/AHgD0qU.png" />
</p>

<p align="center">
<strong>Figure 12-32.</strong> Different instants of the CasePistonDikeAWAS_REG simulation. Colour represents the horizontal velocity of the fluid.
</p>

In this example the force exerted onto the dike is computed using **ComputeForces**, but the overtopping can be also computed using **FlowTool**. The first row of the Figure 12-33 shows the area where the flows will be calculated; the grey box is _ResultFlow_boxes.vtk_ defined in the text file _CasePistonDike_FileBoxes.txt_. The others frames of the Figure 12-33 show the same instant of the simulation with and without AWAS and it can be seen how more particles reach the domain where overtopping will be measure since.

<p align="center">
<img src="https://i.imgur.com/wxIkAL0.png" />
</p>

<p align="center">
<strong>Figure 12-33.</strong> Same instant of the CasePistonDikeAWAS_REG and CasePistonDikeNoAWAS_REG simulations. Colour represents the horizontal.
</p>

Figure 12-34 plots the time series of the accumulative overtopping over the dike with and without AWAS. The overtopping is higher in the case without AWAS since more chaotic wave interactions took place in the tank and higher surface elevation reach the top of the dike, eventually.

<p align="center">
<img src="https://i.imgur.com/2L68wJa.png" />
</p>

<p align="center">
<strong>Figure 12-34.</strong> Comparison between accumulative overtopping with AWAS (CasePistonDikeAWAS_REG) and without (CasePistonDikeNoAWAS_REG) AWAS.
</p>

## 12.11 FLOATING

In this testcase, a 3-D floating box moves due to waves generated with a piston. A sinusoidal movement (`<mvrectsinu>`) is imposed to the boundary particles of the wavemaker and Periodicity in Y direction is also used. _wCaseFloating.bat_ (_xCaseFloating.sh_ in linux) file summarises the tasks to be carried out using the different codes.
Figure 12-35 shows different instants of the simulation of this test case. The floating object is represented using _MotionFloating_xxxx.vtk_ generated using **BoundaryVTK**, the piston with _MotionPiston_xxxx.vtk_ and the fluid with _PartFluid_xxxx.vtk_ (**PartVTK**).

<p align="center">
<img src="https://i.imgur.com/qvdJeiR.png" />
</p>

<p align="center">
<strong>Figure 12-35.</strong> Different instants of the CaseFloating simulation. 
Colour represents velocity of the particles.
</p>

The floating box is created using `<setdrawmode mode="full" />` so particles are located in the faces of the box and inside. Only floating objects created with `<setdrawmode mode="full" />` or `<setdrawmode mode="solid" />` have been validated using **DualSPHysics**. 

The 3-D motions and 3-D rotations of the floating box (mk:61) can be computed using **FloatingInfo** code. Hence, Figure 12-36 shows the time series of the surge, sway and heave motions while Figure 12-37 shows the pitch, roll and yaw angles.

<p align="center">
<img src="https://i.imgur.com/XcOMhvm.png" />
</p>

<p align="center">
<strong>Figure 12-36.</strong> Surge, sway and heave motions of the floating box.
</p>

<p align="center">
<img src="https://i.imgur.com/CivJMoN.png" />
</p>

<p align="center">
<strong>Figure 12-37.</strong> Pitch, roll and yaw rotation of the floating box.
</p>

In addition, a 2-D case of a falling sphere is also provided to simulate the buoyancy-driven motion of an unrestricted rigid body. The sphere has a relative density compared with water of 1.2 (density=1200 kg/m<sup>3</sup>). 

Different instants of the CaseFloatingSphereVal2D simulation can be observed in Figure 12-38 where _PartFluid_xxxx.vtk_, _PartFloating_xxxx.vtk_ (obtained using **PartVTK**) and _Slices_0000.vtk_ (obtained using **IsoSurface**) are depicted.

<p align="center">
<img src="https://i.imgur.com/CJ2v7TH.png" />
</p>

<p align="center">
<strong>Figure 12-38.</strong> Different instants of the CaseFloatingSphereVal2D simulation. Colour represents velocity of the fluid particles.
</p>

The file _EXP_FloatingSphereVal2D.ods_ contains the experimental displacement and velocity of experiments in [Fekken, 2004] and [Moyo and Greenhow, 2000] that can be numerically computed using the **FloatingInfo** code. Validation results can be also seen in [Canelas et al., 2015] where spheres are also created using `<setdrawmode mode="full" />`.

## 12.12 FLOATINGWAVES

This folder includes two cases of floating boxes under the action of waves that can be validated with experimental data (included in the folder):
* CaseFloatingWavesVal aims to reproduce the experiment of [Hadzic et al., 2005].
* CaseFloatingWavesVal2 aims to reproduce the experiment of [Ren et al., 2015].

**CaseFloatingWavesVal**

A 2-D case is designed where a floating box (density=680 kg/m<sup>3</sup>) moves under the action of non-linear waves in a tank with flap that reads rotational motion from an external file _CaseFloatingWavesVal_Flap.dat_ (time & angle) using `<mvrotfile>`.

_wCaseFloatingWavesVal.bat_ (_xCaseFloatingWavesVal.sh_ in linux) file summarises the tasks to be carried out using the different codes.

Different instants of the _CaseFloatingWavesVal_ simulation are shown in Figure 12-39 where the _PartFluid_xxxx.vtk_ of the fluid particles, the _PartMotion_xxxx.vtk_ of the piston and the _PartFloating_xxxx.vtk_ of the floating box are depicted.

<p align="center">
<img src="https://i.imgur.com/FDgANo3.png" />
</p>

<p align="center">
<strong>Figure 12-39.</strong> Different instants of the CaseFloatingWavesVal simulation. Colour represents the horizontal velocity of the fluid.
</p>

The force exerted onto the floating box has been also computed using **ComputeForces** (mk=61). Figure 12-40 shows the time series of the horizontal numerical force.

<p align="center">
<img src="https://i.imgur.com/1kJ5m4b.png" />
</p>

<p align="center">
<strong>Figure 12-40.</strong> Force (X-component) exerted on the floating box in CaseFloatingWavesVal. 
</p>

The 2-D motion of the floating box (surge, heave) and 2-D rotation (roll) can be computed using **FloatingInfo** code as shown in Figure 12-41.

<p align="center">
<img src="https://i.imgur.com/YrefZre.png" />
</p>

<p align="center">
<strong>Figure 12-41.</strong> Surge, heave and roll of the floating box in CaseFloatingWavesVal.
</p>

Experimental data from [Hadzic et al., 2005] is included in the file _EXP_FloatingWavesVal_Hadzic_et_al_2005.ods_. This validation can be also seen at [http://dual.sphysics.org/index.php/validation/wavesfloatings/](http://dual.sphysics.org/index.php/validation/wavesfloatings/).

**CaseFloatingWavesVal 2**

The case consists of a 2-D floating box that moves under the action of waves. The box is 0.3m wide and 0.2 m tall with a density of 500 kg/m<sup>3</sup>. The piston moves to create regular waves with wave height of 0.1 m, period of 1.2 s with a water depth of 0.4m.

_wCaseFloatingWavesVal2.bat_ (_xCaseFloatingWavesVal2.sh_ in linux) file summarises the tasks to be carried out in this example.

Different instants of the _CaseFloatingWavesVal2_ simulation are shown in Figure 12-42 where the _PartFluid_xxxx.vtk_ of the fluid particles, the _PartMotion_xxxx.vtk_ of the piston and the _PartFloating_xxxx.vtk_ of the floating box are depicted.

<p align="center">
<img src="https://i.imgur.com/AGr6EjN.png" />
</p>

<p align="center">
<strong>Figure 12-42.</strong> Different instants of the CaseFloatingWavesVal2 simulation. Colour represents the horizontal velocity of the fluid.
</p>

**IsoSurface** is also executed here to obtain the slices (instead of the isosurface). Therefore, an instant using the file _Slices_xxx.vtk_ can be seen in Figure 12-43.

<p align="center">
<img src="https://i.imgur.com/bbRu6rH.png" />
</p>

<p align="center">
<strong>Figure 12-43.</strong> Instant of the CaseFloatingWavesVal2 simulation plotting Slices_0110.vtk. Colour represents the horizontal velocity of the fluid.
</p>

The 2-D motion of the floating box (surge, heave) and 2-D rotation (roll angle) can be computed using **FloatingInfo** code as shown in Figure 12-44.

<p align="center">
<img src="https://i.imgur.com/P4svWCq.png" />
</p>

<p align="center">
<strong>Figure 12-44.</strong> Surge, heave and roll of the floating box in CaseFloatingWavesVal2.
</p>

Experimental data from [Ren et al., 2015] is included in the file _EXP_FloatingWavesVal2_Ren_et_al_2015.ods_. This validation can be also seen at [https://youtu.be/VDa4zcMDjJA](https://youtu.be/VDa4zcMDjJA). 

## 12.13 PUMP

This 3-D testcase loads an external geometry of a pump created with CAD (Figure 9-4). Two files are used; a fixed object (_pump_fixed.vtk_) and a moving part (_pump_moving.vtk_) that describes a rotational movement (`<mvrotace>`) and the reservoir is pre-filled with fluid particles (`<fillbox>`). _wCasePump.bat_ (_xCasePump.sh_ in linux) file summarises the tasks to be carried out using the different codes.

In Figure 12-45, the fixed _Pumpfixed.vtk_, the different _MotionPump.vtk_ and the _PartFluid_xxxx.vtk_ files of the fluid particles are represented at different instants of the simulation. 

<p align="center">
<img src="https://i.imgur.com/TLyy858.png" />
</p>

<p align="center">
<strong>Figure 12-45.</strong> Different instants of the CasePump simulation. Colour represents the density of the fluid particles.
</p>

## 12.14 DEM

This folder includes cases to be executed using DEM for the interaction between solids (RigidAlgorithm=2 in the XML). 

The first simulation demonstrates a ball hitting several blocks without any fluid particles being created. The file _Floating_Materials.xml_ contains properties of different materials; the ball and the bottom are defined as “steel” and the blocks are “pvc”. These means that those objects will use the parameters of that material; Young modulus, Poisson’s ratio, restitution coefficient and friction coefficient. 
_wCaseBowling.bat_ (_xCaseBowling.sh_ in linux) file summarises the tasks to be carried out using the different codes.

Different instants of the simulation plotting the files _PartSolids_xxxx.vtk_ can be seen in Figure 12-46. 

<p align="center">
<img src="https://i.imgur.com/4EzPATX.png" />
</p>

<p align="center">
<strong>Figure 12-46.</strong> Different instants of the CaseBowling simulation.
</p>

The second DEM simulation consists of a 3-D dam-break flow impacting several blocks. Interaction between fluid and solids are computed using SPH and interaction between blocks and the blocks and the tank walls are computed using DEM. The file _Floating_Materials.xml_ contains properties of different materials; the walls and bottom of the tank are defined as “steel” and the blocks are “pvc”. 

_wCaseSolids.bat_ (_xCaseSolids.sh_ in linux) file summarises the tasks to be carried out using the different codes.

Figure 12-47 shows different instants of the simulation using the files _MotionBlocks_xxxx.vtk_ and _PartFluid_xxxx.vtk_. 

<p align="center">
<img src="https://i.imgur.com/ctLE2jR.png" />
</p>

<p align="center">
<strong>Figure 12-47.</strong> Different instants of the CaseSolids simulation. Colour represents the velocity of the fluid.
</p>

The third example using DEM includes an example of how to simulate a large number of floating objects. 2000 floating objects and no fluid are created in this case. The file _Floating_Materials.xml_ contains properties of different materials; the first 1000 floating objects will have properties of “hard-wood” and the other 1000 are “pvc”, all with a density of 300 kg/m<sup>3</sup>.

_wCaseManyFloatings.bat_ (_xCaseManyFloatings.sh_ in linux) file summarises the tasks to be carried out using the different codes. This scripts use a different version of **GenCase** (GenCase4_MkWord) that allows to create more floating or moving objects. 

The code **BoundaryVTK** is used to create **_MotionSpheres_xxxx.vtk_** that are depicted in Figure 12-48. Colour represents the ID of the objects.

<p align="center">
<img src="https://i.imgur.com/JY3mT1z.png" />
</p>

<p align="center">
<strong>Figure 12-48.</strong> Different instants of the CaseManyFloatings simulation. Colour represents the Id of the objects.
</p>

## 12.15 POISEUILLE 

This test consists of a laminar flow between two parallel plates produced by a pressure gradient. 
* Distance between plates is 0.001 m.
* The density of fluid is 1000 kg/m<sup>3</sup>. 
* Fluid particles are induced by an acceleration of 1x10<sup>-4</sup> m/s<sup>2</sup>.
* Laminar viscosity is used here; ν = 1x10-6 m<sup>2</sup>/s. 

The analytical solution of this problem is:
<p align="center">
<img src="https://i.imgur.com/JWXQkJA.png" />
</p>

Note that this case can only provide accurate results if resolution is high since the gap (on the order of 1.5h) between the fluid and DBC solid particles needs to be reduced as much as possible. Therefore, an initial particle distance of 2x10<sup>-5</sup> m was used, which means that initially there are 50 particles between plates.

<p align="center">
<img src="https://i.imgur.com/U80m3ar.png" />
</p>

<p align="center">
<strong>Figure 12-49.</strong> Different instants of the CasePoiseuille simulation.
</p>

The velocity profiles of the three instants depicted in Figure 12-49 can be numerically computed using **MeasureTool** and compared with the analytical solution. The file _CasePoiseuille_PointsVelocity.txt_ contains the position to compute the horizontal velocity and _Poiseuille_SPHvsAnalytical.ods_ contains the comparison with the analytical solution. Figure 12-50 plots these results. 

<p align="center">
<img src="https://i.imgur.com/3sbAQcH.png" />
</p>

<p align="center">
<strong>Figure 12-50.</strong> Comparison between analytical and numerical velocity profiles for different instants of the CasePoiseuille simulation.
</p>

## 12.16 EXTRA EXAMPLES

**ExternalDtFile**
The XML file named “_Dam2dDtFile.xml_” shows how to use predefined values of the time step “Δt” instead of the automatic computation of the variable time step (according to Eq. 30) by including the line:
`<parameter key="DtFixed" value="Dam2dDtFileData.txt" />`
The file _Dam2dDtFileData.txt_ includes the predefined values of the time steps (in ms). 

**ExternalViscoFile**
The XML file named “_Dam2dViscoFile.xml_” shows how to use predefined values of visco parameter (α in Eq. 8 of the artificial viscosity or υo in Eq. 9 of the laminar viscosity) that changes in time by including the line:
`<parameter key="ViscoTime" value="Dam2dViscoFileData.txt" />`
The file _Dam2dViscoFileData.txt_ includes the predefined values of _visco_.

**GaugeSystem**
This folder contains several examples of how to compute different magnitudes during the execution of DualSPHysics. This functionality can be very useful to obtain information _on the fly_. 
The XML section `<gauge>` includes different options: 
* default: defines configuration of all gauges (create VTK, output frequency, etc)
* swl: computes free surface along a line according to the direction defined by the order of the two points that defined that line (this option is used in AWAS)
* velocity: computes velocity at a given position 
* maxz: computes maximum Z-position of fluid along a vertical line
_GSwl_Dam2d.xml_: example to compute free surface
_GVel_Dam2d.xml_: example to compute velocity
_WallRegAwas2.xml_: example to save free surface that AWAS is internally using
Note that CaseDambreaVal2D in **examples\main\01_DamBreak** also includes an example of the use of `<gauge>`. 

**PosDouble**
The XML file named “_PDam2d.xml_” shows how to use double precision by including the line:
`<parameter key="PosDouble" value="2" />`
This option means that particle interaction is performed using double precision for variables of position and final position is stored using double precision. The use of double is important to solve problems and instabilities when the domain is huge in comparison to the distance of interaction between particles.

**RedrawGenCase**
This folder includes examples of how to create particles and modify properties (mk, type, …) of others previously created or how to create particles in the border of an object, which can be useful for example to avoid holes in the boundaries.
As mentioned in Section 9, **Gencase** employs a 3-D Cartesian lattice to locate particles. These particles are created at the nodes of that lattice.  A value of “mk” is assigned to each node according to the type of particle (boundary, fluid or void) and to define a special behaviour during the simulation.

The `<redraw>` command assigns the “mk” defined by the last `<setmkvoid>`, `<setmkbound>` or `<setmkfluid>` to all nodes that follow a given condition. 

**Example A:**

`<setmkbound mk="3" /> defines the “mk” for the nodes starting from here `
`<redraw mkfluid="1" /> changes all previous cells with mkfluid=1`

The `<redrawnear>` command allows to indicate the nodes that will be modified if there is a neighbouring node that follows some given condition.

Example B:

`<redrawnear targettp="fluid" bordertp="bound" /> modifies all nodes of fluid (targettp="fluid") that have a neighbouring node of type boundary (bordertp="bound")`

Example C:

`<redrawnear targettp="void" bordertp="bound" bordermk="2" /> modifies all nodes of type void (targettp="void") that have a neighbouring node of type boundary (bordertp="bound") and with mk=2 (bordermk="2")`

These three examples are shown in Figure 12-51. Note that squares are used here to represent the individual nodes (particles will be created in those nodes) for clarity.

<p align="center">
<img src="https://i.imgur.com/qp3z8Rq.png" />
</p>

<p align="center">
<strong>Figure 12-51.</strong> Example A, B and C of the use of <redraw> and <redrawnear> commands.
</p>

The `<redrawnear>` command can also indicate how many times the task should be done using times=”2”. In addition, the domain of nodes that will be modified can be defined using variants `<redrawbox>` o `<redrawnearbox>`.

One of the examples included in this folder is _RedrawSimple.xml_ where `<redraw>` is employed to close the holes in the boundary before filling with fluid (see Figure 12-52). The cases _RedrawComplex.xml_ y _RedrawComplexPeriodic.xml_ are more complex cases where the all options of `<redraw>` and `<redrawnear>` are used. 

<p align="center">
<img src="https://i.imgur.com/6xquz9W.png" />
</p>

<p align="center">
<strong>Figure 12-52.</strong> Different steps of the tasks in the example RedrawSimple.xml.
</p>

**ReStart**

Once a simulation with DualSPHysics was executed and finished or incomplete, the simulation can be executed again starting from the last time step. It is worth noting that two folders are necessary; one to include the output data of the first run and a second folder to include the output data of the continuation of the simulation. Thus, the last time step of the first run is used as the first time step of the second run using the `–partbegin` option.

The script file named _wCaseOpenFtMove_win64_GPU.bat_ includes an example to restart a simulation and to use the post-processing tools with output data generated in two different folders (_xCaseOpenFtMove_win64_GPU.sh_ in linux). 

The example included in the folder follows these steps:

_CaseOpenFtMove_Def.xml_; TimeMax=4s & TimeOut=0.01s so 400 files will be created.

1. Creates the output folder _CaseOpenFtMove_out_
2. Executes **GenCase **
3. Executes DualSPHysics to simulate the time interval _0-1 seconds (100 output files)_
`DualSPHysics.exe -gpu CaseOpenFtMove_out/CaseOpenFtMove CaseOpenFtMove_out -tmax:1`
4. Executes **PartVTK**, **BoundaryVTK**, **IsoSurface**, **FloatingInfo** and **MeasureTool**

In _CaseOpenFtMove_out_ we can find the first 100 files (from 0 to 100) that will be the .bi4 files and the ones generated by the post-processing tools.

5. Creates the output folder _CaseOpenFtMove_restart_out_
6. Executes **GenCase** 
7. Executes **DualSPHysics** to simulate the time interval _1-4 seconds (300 more files)_
`DualSPHysics.exe -gpu CaseOpenFtMove_restart_out/CaseOpenFtMove CaseOpenFtMove_restart_out -partbegin:100 CaseOpenFtMove_out`
8. Executes **PartVTK**, **BoundaryVTK**, **IsoSurface**, **FloatingInfo** and **MeasureTool**
Note that now for the second run, BoundaryVTK also uses `-motiondata0`.

In _CaseOpenFtMove_restart_out_ we can find the next 300 files (from 100 to 400) that will be the .bi4 files and the ones generated by the post-processing tools.

**RotatedBox**

This folder includes an example of using `<rotateaxis>`. 
In _RotatedBox.xml_, two different boxes will be created; 

i) one box is created based on the 3-D Cartesian lattice used by GenCase, so that, the particles will be created in the nodes of that lattice (red box in Figure 12-53)

ii) the second box, is initially created using `<drawbox>` and later uses `<rotateaxis>` (in `<initials>` section) to apply a matrix that rotates the position of the particles of the box, so that, particles are finally created in global positions that are not linked to the nodes of the 3-D lattice (green box in Figure 12-53).

Hence, the “stair” effect observed in the red box is no longer observed in the green one.

<p align="center">
<img src="https://i.imgur.com/3EN2fs3.png" />
</p>

<p align="center">
<strong>Figure 12-53.</strong> Geometry generated using RotatedBox.xml.
</p>

**SaveDt** 
The XML file named “_Case5aSvdt_8k.xml_” shows how to save information about the time steps “Δt”. The value of the time step at each step is variable and computed according to Eq. 30. With this option, the user can save for a given interval of the simulation the different values that are used to determine the new time step; maximum accelerations, viscous terms, maximum velocity, ∆tf (based on the force) and ∆tcv (combines the Courant and the viscous terms). 

**TimeOut**
The XML file named “Dam2d.xml” shows how to modify the frequency to store output data for a given interval using <timeout>. This can be useful to store more output files (more frequently) to get more information during some interesting time intervals and less frequent the rest of the simulation. 


## 12.17 MULTIPHASE EXAMPLES

In the folder **examples\twophases\DSPH_v3.4_LiquidSediment**, there is an example of a case with two phases; water and sediment. A PDF document is attached with detailed description of the case: “Guide_CaseDambreak_Sediment.pdf” 

_wCaseDambreak_Sediment.bat_ (_xCaseDambreak_Sediment.sh_ in linux) file summarises the tasks to be carried out using the different codes.

Different instants of the simulation plotting _CaseDambreak_Sediment_Bound.vtk_, the files _PartFluid_xxxx.vtk_ and _PartSediment_xxxx.vtk_ can be seen in Figure 12-54. 

<p align="center">
<img src="https://imgur.com/SDt9cv7.png" />
</p>

<p align="center">
<strong>Figure 12-54.</strong> Different instants of the CaseDambreak_Sediment simulation.
</p>

<br>

The following test cases are included in **examples\twophases\DSPH_v4.0_LiquidGas**:

<p align="center">
<img src="https://imgur.com/50WTSYV.png" />
</p>
<p align="center">
<img src="https://imgur.com/400PCbO.png" />
</p>

<p align="center">
<strong>Figure 12-55.</strong> Testcases of the multiphase code Liquid-Gas.
</p>

