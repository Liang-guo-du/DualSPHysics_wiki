A program named **GenCase** is included to define the initial configuration of the simulation, movement description of moving objects and the parameters of the execution in DualSPHysics. All this information is contained in a definition **input file** in XML format; **Case_Def.xml**. Two **output files** are created after running GenCase: **Case.xml** and **Case.bi4** (the input files for DualSPHysics code). These input (red boxes) and output files (blue boxes) can be observed in Figure 9-1. **Case.xml** contains all the parameters of the system configuration and its execution such as key variables (smoothing length, reference density, gravity, coefficient to calculate pressure, speed of sound…), the number of particles in the system, movement definition of moving boundaries and properties of moving bodies. **Case.bi4** contains the initial state of the particles (number of particles, position, velocity and density) in BINX4 (.bi4) format. Particle geometries created with **GenCase** can be initially checked by visualising in Paraview the files **Case_All.vtk**, **Case_Bound.vtk** and **Case_Fluid.vtk**. Note that **Case_MkCells.vtk** contains planes that represent sets of all particles (grouped with the same mk) with the advantage that this file is one thousand times less heavy to easily visualise huge cases.

<p align="center">
<img src="https://i.imgur.com/qrEyGFl.png" width="450px" />
</p>

<p align="center">
<strong>Figure 9-1.</strong> Input (red) and output (blue) files of GenCase code.
</p>

GenCase employs a 3-D Cartesian mesh to locate particles. The idea is to build any object using particles. These particles are created at the nodes of the 3-D Cartesian mesh. Firstly, the mesh nodes around the object are defined and then particles are created only in the nodes needed to draw the desired geometry. Figure 9-2 illustrates how this mesh is used; in this case a triangle is generated in 2D. First the nodes of a mesh are defined starting from the maximum dimensions of the desired triangle, then the edges of the triangle are defined and finally particles are created at the nodes of the Cartesian mesh which are inside the triangle.

<p align="center">
<img src="https://i.imgur.com/2tCsqNX.jpg" />
</p>

<p align="center">
<strong>Figure 9-2.</strong> Generation of a 2-D triangle formed by particles using GenCase.
</p>

All particles are placed over a regular Cartesian grid. The geometry of the case is defined independently to the inter-particle distance. This allows the discretization of each test case with a different number of particles simply by varying the resolution (or particle size) _dp_. Furthermore, **GenCase** is very fast and able to generate millions of particles only in seconds on the CPU.  

Very complex geometries can be easily created since a wide variety of commands (labels in the XML file) are available to create different objects; points, lines, triangles, quadrilateral, polygons, pyramids, prisms, boxes, beaches, spheres, ellipsoids, cylinders, waves (`<drawpoint />, <drawpoints />, <drawline />, <drawlines />, <drawtriangle />, <drawquadri />, <drawtrianglesstrip />, <drawtrianglesfan />, <drawpolygon>, <drawtriangles />, <drawpyramid  />, <drawprism />, <drawbox />, <drawbeach />, <drawsphere />, <drawellipsoid />, <drawcylinder />, <drawwave />`).

Once the mesh nodes that represent the desired object are selected, these points are stored as a matrix of nodes. The shape of the object can be transformed using a translation (`<move />`), a scaling (`<scale />`) or a rotation (`<rotate />`, `<rotateline />`). With the generation process creating particles at the nodes, different types of particles can be created; a fluid particle (`<setmkfluid />`), a boundary particle (`<setmkbound />`) or none (`<setmkvoid />`). Hence, **mk** is the marker value used to mark a set of particles with a common feature in the simulation. Note that values of the final **mk** are different to **mkfluid**, **mkbound** and **mkvoid** following the rules:

**mk** for boundaries = **mkbound** + 11

**mk** for fluid particles = **mkfluid** + 1

Particles can be created only at the object surface (`<setdrawmode mode="face" />`), or only inside the bounds of the objects (`<setdrawmode mode="solid" />`) or both (`<setdrawmode mode="full" />`). 

The set of fluid particles can be labelled with features or special behaviours (`<initials />`). For example, initial velocity (`<velocity />`) can be imposed for fluid particles or a solitary wave can be defined (`<velwave />`). Furthermore, particles can be defined as part of a floating object (`<floatings />`). 

Once boundaries are defined, filling a region with fluid particles can be easily obtained using the following commands: (`<fillpoint />`, `<fillbox />`, `<fillfigure />`, `<fillprism />`). This works also in the presence of arbitrarily complex geometries.    

In cases with more complex geometries, external objects can be imported from 3DS files (Figure 9-3) or CAD files (Figure 9-4). This enables the use of realistic geometries generated by 3D designing application with the drawing commands of GenCase to be combined. These files (3DS or CAD) must be converted to STL format (`<drawfilestl />`), PLY format (`<drawfileply />`) or VTK format (`<drawfilevtk />`), formats that are easily loaded by **GenCase**. Any object in STL, PLY or VTK (_object.vtk_, _object.stl_ or _object.ply_ in Figure 9-1) can be split in different triangles and any triangle can be converted into particles using the **GenCase** code.

<p align="center">
<img src="https://i.imgur.com/QRY2q4G.png" width="500px" />
</p>

<p align="center">
<strong>Figure 9-3.</strong> Example of a 3D file imported by GenCase and converted into particles.
</p>

<p align="center">
<img src="https://i.imgur.com/VqskWxQ.png" width="500px"/>
</p>

<p align="center">
<strong>Figure 9-4.</strong> Example of a CAD file imported by GenCase and converted into particles.
</p>

Different kinds of movements can be imposed to a set of particles; linear, rotational, circular, sinusoidal, etc. To help users define movements, a directory with some examples is also included in the DualSPHysics package. Thus, the directory **DualSPHysics_v4.2/examples/motion** includes:
* Motion01: uniform rectilinear motion (`<mvrect />`) that also includes pauses (`<wait />`) 
* Motion02: combination of two uniform rectilinear motion (`<mvrect />`)
* Motion03: movement of an object depending on the movement of another (hierarchy of objects)
* Motion04: accelerated rectilinear motion (`<mvrectace />`)
* Motion05: rotational motion (`<mvrot />`). See Figure 9-5.
* Motion06: accelerated rotation motion (`<mvrotace />`) and accelerated circular motion (`<mvcirace />`). See Figure 9-6.
* Motion07: sinusoidal movement (`<mvrectsinu />`, `<mvrotsinu />`, `<mvcirsinu />`)
* Motion08: prescribed with data from an external file (time, position) (`<mvfile/>`)
* Motion09: prescribed with data from an external file (time, angle) (`<mvrotfile />`)

<p align="center">
<img src="https://i.imgur.com/NBHRPLe.png" width="400px"/>
</p>

<p align="center">
<strong>Figure 9-5.</strong> Example of rotational motion.
</p>

<p align="center">
<img src="https://i.imgur.com/DQtKQxs.png" width="400px" />
</p>

<p align="center">
<strong>Figure 9-6.</strong> Example of accelerated rotation motion and accelerated circular motion.
</p>

Please, note that there are two versions of the GenCase code:
* GenCase4_win64.exe / GenCase4_linux64
* GenCase4_MkWord_win64.exe / GenCase4_MkWord_linux64
GenCase4_MkWord_win64 allows the user to create up to 65000 floating or solid objects while GenCase4_win64 allows to create only 240 objects, but it is faster and needs 50% less memory, so that, it is suitable for cases with large number of particles.

## TO RUN GENCASE: 
### example: `GenCase Case_Def Case [options]`
where _Case_Def_ is the name of the input file (Case_Def.xml as seen in Figure 9-1) and Case will be the name of the output files (Case.xml and Case.bi4) and the _options _are:

**-h**
Shows information about the different parameters. Typing “GenCase –h” in the command window generates a brief help manual (available in **doc/help** folder).

**-ver**
Shows version information

**-template**
Generates the example file CaseTemplate.xml that is already generated and saved in doc/xml_format folder.

**-dp:<float>**
Defines the distance between particles. By varying this parameter the number of particles will be modified without changing any other data since all dimensions are given in global dimensions.

**-ompthreads:<int>**  
Indicates the number of threads by host for parallel execution, it takes the number of cores of the device by default (or using zero value).

**-save:<values>**
Indicates the format of output files. 
* +/-**all**: To choose or reject all options
* +/-**bi**: Binary format for the initial configuration (by default)
* +/-**vtkall**: VTK with all particles of the initial configuration
* +/-**vtkbound**: VTK with boundary particles of the initial configuration
* +/-**vtkfluid**: VTK with fluid particles of the initial configuration

Note that when using –save:all, the files **Case_All.vtk**, **Case_Bound.vtk** and **Case_Fluid.vtk** of Figure 9-1 are also generated and should be visualised to check the generated particles before launching the simulation.

**-debug:<int>**
Debug level (-1:Off, 0:Explicit, n:Debug level)

**-createdirs:<0/1>**
Creates full path for output files (value by default is read from DsphConfig.xml or 1)

**Examples:**
* `GenCase4 citydef city` (_“citydef” is the name of the input file and “city” is the name of the output files_)
* `GenCase4 case case -dp:0.01` (_“case” is the name of the input file and “case” is also the name of the output files, but “dp” is changed_)

A more complete description of the code and the XML files can be found in **XML_v4.4_GUIDE.pdf** available in **DualSPHysics_v4.4/doc/guides**. This document helps to create a new case using the input XML file and all XML parameters are explained and related to SPH equations.

An example of input XML is shown here; the CaseWavemaker_Def.xml included in **DualSPHysics_v4.4/examples/main/06_Wavemaker**:

<p align="center">
<img src="https://i.imgur.com/vKw4Vtt.png"/>
</p>